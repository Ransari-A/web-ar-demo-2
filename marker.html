<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Marker-based AR with Sound</title>

  <!-- Load A-Frame and AR.js -->
  <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
  <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>

  <style>
    body {margin:0;overflow:hidden}
    #audioBtn {
      position: fixed; top:15px; left:50%; transform:translateX(-50%);
      background:#111;color:#fff;border:0;border-radius:10px;
      padding:10px 16px;font:600 14px system-ui;cursor:pointer;z-index:9999;
    }
    #audioBtn.hidden {display:none;}
  </style>
</head>

<body>
  <button id="audioBtn">Tap to Enable Sound</button>

  <a-scene embedded arjs="sourceType: webcam; debugUIEnabled: false;">
    <a-assets>
      <a-asset-item id="model" src="my3d.glb"></a-asset-item>
      <audio id="sound" src="mysound.mp3" preload="auto"></audio>
    </a-assets>

    <a-marker preset="hiro" id="marker">
      <a-entity gltf-model="#model"
                scale="1 1 1"
                position="0 0 0"
                rotation="0 0 0"
                animation-mixer
                sound="src: #sound; autoplay: false; loop: true; positional: true">
      </a-entity>
    </a-marker>

    <a-entity camera></a-entity>
  </a-scene>

  <script>
    const btn = document.getElementById('audioBtn');
    const scene = document.querySelector('a-scene');
    let unlocked = false;

    function unlock() {
      const l = scene.audioListener;
      if (l && l.context && l.context.state !== 'running') l.context.resume();
      unlocked = true;
      btn.classList.add('hidden');
    }
    btn.addEventListener('click', unlock);

    const marker = document.getElementById('marker');
    const entity = document.querySelector('[sound]');
    marker.addEventListener('markerFound', ()=>{ if(unlocked) entity.components.sound.playSound(); });
    marker.addEventListener('markerLost', ()=>{ entity.components.sound.stopSound(); });
  </script>
</body>
</html>
